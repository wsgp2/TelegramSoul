#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
"""
import json

# –î–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ (–∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –ª–æ–≥–æ–≤)
raw_topics_data = [
    # –ß–∞—Å—Ç—å 1
    {
        "name": "–õ—é–±–æ–≤—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å",
        "percentage": 20.0
    },
    {
        "name": "–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –¥–æ—Ö–æ–¥", 
        "percentage": 18.0
    },
    {
        "name": "–õ–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –∏ –∑–∞–±–æ—Ç–∞ –æ –¥–µ—Ç—è—Ö",
        "percentage": 11.0
    },
    
    # –ß–∞—Å—Ç—å 2  
    {
        "name": "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è",
        "percentage": 25.0
    },
    {
        "name": "–°–µ—Ç–µ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤—Å—Ç—Ä–µ—á–∏",
        "percentage": 5.0
    },
    
    # –ß–∞—Å—Ç—å 3
    {
        "name": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
        "percentage": 15.0
    },
    {
        "name": "–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–æ–µ–∫—Ç—ã",
        "percentage": 12.0
    },
    
    # –ß–∞—Å—Ç—å 4
    {
        "name": "–¢–æ—Ä–≥–æ–≤–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏", 
        "percentage": 35.0
    },
    {
        "name": "–°–æ–±—ã—Ç–∏—è –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥",
        "percentage": 20.0
    },
    
    # –ß–∞—Å—Ç—å 5
    {
        "name": "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã",
        "percentage": 25.0
    },
    {
        "name": "–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
        "percentage": 5.0
    },
    
    # –ß–∞—Å—Ç—å 6
    {
        "name": "–¢—É—Ä–∏–∑–º –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è",
        "percentage": 25.0
    },
    {
        "name": "–ë–∏–∑–Ω–µ—Å –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
        "percentage": 20.0
    },
    
    # –ß–∞—Å—Ç—å 7
    {
        "name": "–í—ã—Ö–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Ä—ã–Ω–æ–∫",
        "percentage": 25.0
    },
    {
        "name": "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
        "percentage": 15.0
    },
    
    # –ß–∞—Å—Ç—å 8
    {
        "name": "–°–µ–∫—Å—É–∞–ª—å–Ω–æ—Å—Ç—å –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –æ–±–º–µ–Ω",
        "percentage": 25.0
    },
    {
        "name": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö",
        "percentage": 20.0
    },
    
    # –ß–∞—Å—Ç—å 9
    {
        "name": "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
        "percentage": 20.0
    },
    {
        "name": "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —à—É—Ç–∫–∏",
        "percentage": 9.0
    },
    
    # –ß–∞—Å—Ç—å 10
    {
        "name": "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏",
        "percentage": 25.0
    },
    {
        "name": "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã",
        "percentage": 5.0
    },
    
    # –ß–∞—Å—Ç—å 11
    {
        "name": "–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏",
        "percentage": 25.0
    },
    {
        "name": "–õ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è –∏ —ç–º–æ—Ü–∏–∏",
        "percentage": 15.0
    },
    
    # –ß–∞—Å—Ç—å 12
    {
        "name": "–î–µ–ª–æ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∏",
        "percentage": 20.0
    },
    {
        "name": "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤–µ—á–µ—Ä–∏–Ω–∫–∏",
        "percentage": 11.0
    },
    
    # –ß–∞—Å—Ç—å 13
    {
        "name": "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
        "percentage": 25.0
    },
    {
        "name": "–ñ–∏–ª–∏—â–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –ë–∞–ª–∏",
        "percentage": 15.0
    },
    
    # –ß–∞—Å—Ç—å 14
    {
        "name": "–ê–∫—Å–µ–ª–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤",
        "percentage": 20.0
    },
    {
        "name": "–ü–æ—Ç–æ–∫ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
        "percentage": 18.0
    },
    
    # –ß–∞—Å—Ç—å 15
    {
        "name": "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—É—Ä–∏–∑–º",
        "percentage": 42.9
    },
    {
        "name": "–í–∏–¥–µ–æ—á–∞—Ç—ã –∏ –æ–Ω–ª–∞–π–Ω-–∏–≥—Ä—ã",
        "percentage": 28.6
    }
]

def aggregate_topics_by_similarity_current_method(topics):
    """–¢–µ–∫—É—â–∏–π –º–µ—Ç–æ–¥ - —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤"""
    print("üî¢ –¢–ï–ö–£–©–ò–ô –ú–ï–¢–û–î (–°–£–ú–ú–ò–†–û–í–ê–ù–ò–ï):")
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ—Ö–æ–∂–∏–µ —Ç–µ–º—ã (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
    groups = {
        "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—É—Ä–∏–∑–º": ["–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", "–¢—É—Ä–∏–∑–º –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è", "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö", "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—É—Ä–∏–∑–º", "–ñ–∏–ª–∏—â–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –ë–∞–ª–∏"],
        "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –±–∏–∑–Ω–µ—Å": ["–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –¥–æ—Ö–æ–¥", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è", "–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–æ–µ–∫—Ç—ã", "–¢–æ—Ä–≥–æ–≤–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã", "–ë–∏–∑–Ω–µ—Å –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏", "–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏", "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–ê–∫—Å–µ–ª–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤", "–ü–æ—Ç–æ–∫ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏"],
        "–°–æ–±—ã—Ç–∏—è –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è": ["–°–µ—Ç–µ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤—Å—Ç—Ä–µ—á–∏", "–°–æ–±—ã—Ç–∏—è –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥", "–î–µ–ª–æ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∏", "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤–µ—á–µ—Ä–∏–Ω–∫–∏"],
        "–õ–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ": ["–õ—é–±–æ–≤—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å", "–õ–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –∏ –∑–∞–±–æ—Ç–∞ –æ –¥–µ—Ç—è—Ö", "–°–µ–∫—Å—É–∞–ª—å–Ω–æ—Å—Ç—å –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –æ–±–º–µ–Ω", "–õ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è –∏ —ç–º–æ—Ü–∏–∏"],
        "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": ["–í—ã—Ö–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Ä—ã–Ω–æ–∫", "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"],
        "–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ": ["–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è"],
        "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": ["–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —à—É—Ç–∫–∏", "–í–∏–¥–µ–æ—á–∞—Ç—ã –∏ –æ–Ω–ª–∞–π–Ω-–∏–≥—Ä—ã"]
    }
    
    result_current = {}
    
    for group_name, topic_names in groups.items():
        total_percentage = 0
        count = 0
        
        for topic in topics:
            if topic["name"] in topic_names:
                total_percentage += topic["percentage"]
                count += 1
        
        if count > 0:
            result_current[group_name] = {
                "percentage": total_percentage,
                "parts_found": count,
                "method": "—Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"
            }
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é
    sorted_current = sorted(result_current.items(), key=lambda x: x[1]["percentage"], reverse=True)
    
    for topic_name, data in sorted_current:
        print(f"  {topic_name}: {data['percentage']:.1f}% (–Ω–∞–π–¥–µ–Ω–æ –≤ {data['parts_found']} —á–∞—Å—Ç—è—Ö)")
    
    return result_current

def aggregate_topics_by_similarity_new_method(topics):
    """–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ - —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤"""
    print("\nüìä –ù–û–í–´–ô –ú–ï–¢–û–î (–£–°–†–ï–î–ù–ï–ù–ò–ï):")
    
    # –¢–µ –∂–µ –≥—Ä—É–ø–ø—ã
    groups = {
        "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—É—Ä–∏–∑–º": ["–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", "–¢—É—Ä–∏–∑–º –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è", "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –æ—Ç–¥—ã—Ö", "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—É—Ä–∏–∑–º", "–ñ–∏–ª–∏—â–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –ë–∞–ª–∏"],
        "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –±–∏–∑–Ω–µ—Å": ["–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –¥–æ—Ö–æ–¥", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è", "–ë–∏–∑–Ω–µ—Å –∏ –ø—Ä–æ–µ–∫—Ç—ã", "–¢–æ—Ä–≥–æ–≤–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã", "–ë–∏–∑–Ω–µ—Å –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏", "–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏", "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "–ê–∫—Å–µ–ª–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤", "–ü–æ—Ç–æ–∫ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏"],
        "–°–æ–±—ã—Ç–∏—è –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è": ["–°–µ—Ç–µ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤—Å—Ç—Ä–µ—á–∏", "–°–æ–±—ã—Ç–∏—è –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥", "–î–µ–ª–æ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∏", "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤–µ—á–µ—Ä–∏–Ω–∫–∏"],
        "–õ–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ": ["–õ—é–±–æ–≤—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å", "–õ–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –∏ –∑–∞–±–æ—Ç–∞ –æ –¥–µ—Ç—è—Ö", "–°–µ–∫—Å—É–∞–ª—å–Ω–æ—Å—Ç—å –∏ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –æ–±–º–µ–Ω", "–õ–∏—á–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è –∏ —ç–º–æ—Ü–∏–∏"],
        "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": ["–í—ã—Ö–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Ä—ã–Ω–æ–∫", "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"],
        "–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ": ["–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è"],
        "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": ["–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —à—É—Ç–∫–∏", "–í–∏–¥–µ–æ—á–∞—Ç—ã –∏ –æ–Ω–ª–∞–π–Ω-–∏–≥—Ä—ã"]
    }
    
    result_new = {}
    
    for group_name, topic_names in groups.items():
        total_percentage = 0
        count = 0
        
        for topic in topics:
            if topic["name"] in topic_names:
                total_percentage += topic["percentage"]
                count += 1
        
        if count > 0:
            # –£–°–†–ï–î–ù–ï–ù–ò–ï –≤–º–µ—Å—Ç–æ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
            average_percentage = total_percentage / count
            result_new[group_name] = {
                "percentage": average_percentage,
                "parts_found": count,
                "method": "—É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ",
                "total_raw": total_percentage
            }
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é
    sorted_new = sorted(result_new.items(), key=lambda x: x[1]["percentage"], reverse=True)
    
    for topic_name, data in sorted_new:
        print(f"  {topic_name}: {data['percentage']:.1f}% (—Å—Ä–µ–¥–Ω–µ–µ –∏–∑ {data['parts_found']} —á–∞—Å—Ç–µ–π, —Å—É–º–º–∞ –±—ã–ª–∞ {data['total_raw']:.1f}%)")
    
    return result_new

def compare_methods():
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤"""
    print("=" * 60)
    print("üßÆ –°–†–ê–í–ù–ï–ù–ò–ï –ú–ï–¢–û–î–û–í –ê–ì–†–ï–ì–ê–¶–ò–ò –ü–†–û–¶–ï–ù–¢–û–í")
    print("=" * 60)
    
    current = aggregate_topics_by_similarity_current_method(raw_topics_data)
    new = aggregate_topics_by_similarity_new_method(raw_topics_data)
    
    print("\n" + "=" * 60)
    print("üìà –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê:")
    print("=" * 60)
    print(f"{'–¢–µ–º–∞':<25} {'–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ':<15} {'–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ':<15} {'–†–∞–∑–Ω–∏—Ü–∞':<10}")
    print("-" * 65)
    
    all_topics = set(current.keys()) | set(new.keys())
    
    for topic in all_topics:
        current_pct = current.get(topic, {}).get('percentage', 0)
        new_pct = new.get(topic, {}).get('percentage', 0)
        diff = new_pct - current_pct
        
        print(f"{topic:<25} {current_pct:<15.1f} {new_pct:<15.1f} {diff:<+10.1f}")
    
    print("\n" + "=" * 60)
    print("ü§î –í–´–í–û–î–´:")
    print("=" * 60)
    
    # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    current_top3 = list(sorted(current.items(), key=lambda x: x[1]["percentage"], reverse=True))[:3]
    new_top3 = list(sorted(new.items(), key=lambda x: x[1]["percentage"], reverse=True))[:3]
    
    print("üìä –¢–û–ü-3 —Å —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º:")
    for i, (name, data) in enumerate(current_top3, 1):
        print(f"  {i}. {name}: {data['percentage']:.1f}%")
    
    print("\nüìä –¢–û–ü-3 —Å —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ–º:")
    for i, (name, data) in enumerate(new_top3, 1):
        print(f"  {i}. {name}: {data['percentage']:.1f}%")
    
    print(f"\nüîç –ò–∑–º–µ–Ω–∏—Ç—Å—è –ª–∏ –ø–æ—Ä—è–¥–æ–∫ —Ç–µ–º? {'–î–ê' if [x[0] for x in current_top3] != [x[0] for x in new_top3] else '–ù–ï–¢'}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç
    max_current = max(current.values(), key=lambda x: x['percentage'])['percentage']
    max_new = max(new.values(), key=lambda x: x['percentage'])['percentage']
    
    print(f"üìà –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç:")
    print(f"  –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ: {max_current:.1f}%")
    print(f"  –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ: {max_new:.1f}%")
    print(f"  –†–∞–∑–Ω–∏—Ü–∞: {max_new - max_current:+.1f}%")

if __name__ == "__main__":
    compare_methods() 